<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Order Management</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="style.css" rel="stylesheet">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
</head>
<body>
    <div class="container-fluid mt-3">
        <div class="row">
            <!-- Filter Card -->
            <div class="col-md-4">
                <div class="card">
                    <div class="card-body">
                        <h5 class="card-title">Filter Orders</h5>
                        <label for="orderValueSlider" class="form-label">Order Value</label>
                        <input type="range" class="form-range" id="orderValueSlider" min="0" max="10000" step="100">
                        <div id="orderValueDisplay">Order Value: $0</div>
                    </div>
                </div>
            </div>
            <!-- Orders Table -->
            <div class="col-md-8">
                <!-- Buttons and Search Box -->
                <div class="d-flex justify-content-end mb-2">
                    <button type="button" class="btn btn-primary me-2" id="addOrderBtn">Add Order</button>
                    <button type="button" class="btn btn-success me-2" id="saveOrdersBtn">Save</button>
                    <input type="text" class="form-control w-auto" id="searchOrders" placeholder="Search Orders by ID">
                </div>
                <!-- Table -->
                <table class="table">
                    <thead>
                        <tr>
                            <th scope="col">Order ID</th>
                            <th scope="col">Order Value</th>
                            <th scope="col">Order Quantity</th>
                            <th scope="col">Action</th>
                        </tr>
                    </thead>
                    <tbody id="orderTableBody">
                        <!-- Rows will be inserted here by jQuery -->
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        // Sample data
        const orders = JSON.parse(localStorage.getItem('orders')) || [
            { id: 1001, value: 200, quantity: 5 },
            { id: 1002, value: 350, quantity: 2 },
            { id: 1003, value: 1250, quantity: 10 }
        ];

        // Function to populate the table
        function populateTable(filterValue = 0, searchTerm = '') {
            const tableBody = $('#orderTableBody');
            tableBody.empty();
            orders.filter(order => order.value > filterValue && order.id.toString().includes(searchTerm)).forEach((order, index) => {
                const row = $(`
                    <tr>
                        <td>${order.id}</td>
                        <td>$${order.value}</td>
                        <td>${order.quantity}</td>
                        <td>
                            <button class="btn btn-sm btn-primary" onclick="editOrder(${index})">Edit</button>
                            <button class="btn btn-sm btn-danger" onclick="deleteOrder(${index})">Delete</button>
                        </td>
                    </tr>
                `);
                tableBody.append(row);
            });
        }

        // Function to save orders to local storage
        function saveOrders() {
            localStorage.setItem('orders', JSON.stringify(orders));
            alert('Orders saved to local storage');
        }

        // Function to edit an order
        function editOrder(index) {
            const tableBody = $('#orderTableBody');
            const row = tableBody.children().eq(index);
            const order = orders[index];

            row.html(`
                <td><input type="text" class="form-control" value="${order.id}" id="editOrderId${index}"></td>
                <td><input type="text" class="form-control" value="${order.value}" id="editOrderValue${index}"></td>
                <td><input type="text" class="form-control" value="${order.quantity}" id="editOrderQuantity${index}"></td>
                <td>
                    <button class="btn btn-sm btn-success" onclick="saveEditedOrder(${index})">Save</button>
                </td>
            `);
        }

        // Function to save the edited order
        function saveEditedOrder(index) {
            const editedId = $(`#editOrderId${index}`).val();
            const editedValue = $(`#editOrderValue${index}`).val();
            const editedQuantity = $(`#editOrderQuantity${index}`).val();

            orders[index] = {
                id: parseInt(editedId),
                value: parseFloat(editedValue),
                quantity: parseInt(editedQuantity)
            };

            populateTable();
        }

        // Function to delete an order
        function deleteOrder(index) {
            orders.splice(index, 1);
            localStorage.setItem('orders', JSON.stringify(orders)); // Update local storage
            populateTable();
        }

        // Initial table population
        $(document).ready(function() {
            populateTable();

            // Event listener for the Add Order button
            $('#addOrderBtn').on('click', function() {
                const tableBody = $('#orderTableBody');
                const newRow = $(`
                    <tr>
                        <td><input type="text" class="form-control" id="newOrderId" placeholder="Order ID"></td>
                        <td><input type="text" class="form-control" id="newOrderValue" placeholder="Order Value"></td>
                        <td><input type="text" class="form-control" id="newOrderQuantity" placeholder="Order Quantity"></td>
                        <td><button class="btn btn-sm btn-success" id="addOrderConfirmBtn">Add</button></td>
                    </tr>
                `);
                tableBody.prepend(newRow);

                $('#addOrderConfirmBtn').on('click', function() {
                    const orderId = $('#newOrderId').val();
                    const orderValue = $('#newOrderValue').val();
                    const orderQuantity = $('#newOrderQuantity').val();

                    if (orderId && orderValue && orderQuantity) {
                        const newOrder = {
                            id: parseInt(orderId),
                            value: parseFloat(orderValue),
                            quantity: parseInt(orderQuantity)
                        };
                        orders.push(newOrder);
                        populateTable();
                    } else {
                        alert('Please fill out all fields');
                    }
                });
            });

            // Event listener for the Save Orders button
            $('#saveOrdersBtn').on('click', saveOrders);

            // Event listener for the order value slider
            $('#orderValueSlider').on('input', function(event) {
                const filterValue = parseInt(event.target.value);
                $('#orderValueDisplay').text(`Order Value: $${filterValue}`);
                const searchTerm = $('#searchOrders').val();
                populateTable(filterValue, searchTerm);
            });

            // Event listener for the search input
            $('#searchOrders').on('input', function(event) {
                const searchTerm = event.target.value;
                const filterValue = parseInt($('#orderValueSlider').val());
                populateTable(filterValue, searchTerm);
            });
        });
    </script>
</body>
</html>
